\doxysection{bno055\+\_\+stm32.\+h}
\hypertarget{bno055__stm32_8h_source}{}\label{bno055__stm32_8h_source}\index{TermProject\_Code/Core/Inc/bno055\_stm32.h@{TermProject\_Code/Core/Inc/bno055\_stm32.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ BNO055\_STM32\_H\_}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ BNO055\_STM32\_H\_}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00005\ \ \ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \{}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{comment}{//\#include\ "{}i2c.h"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifdef\ FREERTOS\_ENABLED}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}FreeRTOS.h"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}task.h"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}cmsis\_os.h"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}bno055.h"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \mbox{\hyperlink{structI2C__HandleTypeDef}{I2C\_HandleTypeDef}}\ *\_bno055\_i2c\_port;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keywordtype}{void}\ bno055\_assignI2C(\mbox{\hyperlink{structI2C__HandleTypeDef}{I2C\_HandleTypeDef}}\ *hi2c\_device)\ \{}
\DoxyCodeLine{00021\ \ \ \_bno055\_i2c\_port\ =\ hi2c\_device;}
\DoxyCodeLine{00022\ \}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keywordtype}{void}\ bno055\_delay(\textcolor{keywordtype}{int}\ time)\ \{}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#ifdef\ FREERTOS\_ENABLED}}
\DoxyCodeLine{00026\ \ \ osDelay(time);}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{group__HAL__Exported__Functions__Group2_gab1dc1e6b438daacfe38a312a90221330}{HAL\_Delay}}(time);}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00030\ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keywordtype}{void}\ bno055\_writeData(uint8\_t\ reg,\ uint8\_t\ data)\ \{}
\DoxyCodeLine{00033\ \ \ uint8\_t\ txdata[2]\ =\ \{reg,\ data\};}
\DoxyCodeLine{00034\ \ \ uint8\_t\ status;}
\DoxyCodeLine{00035\ \ \ status\ =\ HAL\_I2C\_Master\_Transmit(\_bno055\_i2c\_port,\ BNO055\_I2C\_ADDR\ <<\ 1,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ txdata,\ \textcolor{keyword}{sizeof}(txdata),\ 10);}
\DoxyCodeLine{00037\ \ \ \textcolor{keywordflow}{if}\ (status\ ==\ HAL\_OK)\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00039\ \ \ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \textcolor{keywordflow}{if}\ (status\ ==\ HAL\_ERROR)\ \{}
\DoxyCodeLine{00042\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_Master\_Transmit\ HAL\_ERROR\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00043\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (status\ ==\ HAL\_TIMEOUT)\ \{}
\DoxyCodeLine{00044\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_Master\_Transmit\ HAL\_TIMEOUT\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00045\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (status\ ==\ HAL\_BUSY)\ \{}
\DoxyCodeLine{00046\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_Master\_Transmit\ HAL\_BUSY\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00047\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00048\ \ \ \ \ printf(\textcolor{stringliteral}{"{}Unknown\ status\ data\ \%d"{}},\ status);}
\DoxyCodeLine{00049\ \ \ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ uint32\_t\ error\ =\ HAL\_I2C\_GetError(\_bno055\_i2c\_port);}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{if}\ (error\ ==\ \mbox{\hyperlink{group__I2C__Error__Code__definition_ga0b8ca289091d942032c89484b6211d0d}{HAL\_I2C\_ERROR\_NONE}})\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00054\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\ ==\ \mbox{\hyperlink{group__I2C__Error__Code__definition_gab9f6e39431ee764ada50fd63f0ad2fbf}{HAL\_I2C\_ERROR\_BERR}})\ \{}
\DoxyCodeLine{00055\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_ERROR\_BERR\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00056\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\ ==\ \mbox{\hyperlink{group__I2C__Error__Code__definition_ga048b36222884bfe80ce2d37fa868690b}{HAL\_I2C\_ERROR\_ARLO}})\ \{}
\DoxyCodeLine{00057\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_ERROR\_ARLO\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00058\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\ ==\ \mbox{\hyperlink{group__I2C__Error__Code__definition_gad1cc236ad6ba5cafe66aecb0dbedc65a}{HAL\_I2C\_ERROR\_AF}})\ \{}
\DoxyCodeLine{00059\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_ERROR\_AF\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00060\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\ ==\ \mbox{\hyperlink{group__I2C__Error__Code__definition_ga38d8f9beb4c681eba786f6154d4f594a}{HAL\_I2C\_ERROR\_OVR}})\ \{}
\DoxyCodeLine{00061\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_ERROR\_OVR\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00062\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\ ==\ \mbox{\hyperlink{group__I2C__Error__Code__definition_gae1091e9e82dcfcfef247b214a11c9db3}{HAL\_I2C\_ERROR\_DMA}})\ \{}
\DoxyCodeLine{00063\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_ERROR\_DMA\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00064\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\ ==\ \mbox{\hyperlink{group__I2C__Error__Code__definition_gaeb3bedf36d78ddf3284a68494ab9d089}{HAL\_I2C\_ERROR\_TIMEOUT}})\ \{}
\DoxyCodeLine{00065\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_ERROR\_TIMEOUT\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00066\ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{group__HAL__state__structure__definition_gaef355af8eab251ae2a19ee164ad81c37}{HAL\_I2C\_StateTypeDef}}\ state\ =\ HAL\_I2C\_GetState(\_bno055\_i2c\_port);}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a91ba08634e08d7287940f1bc5a37eeff}{HAL\_I2C\_STATE\_RESET}})\ \{}
\DoxyCodeLine{00070\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_RESET\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00071\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37af859ce60c5e462b0bfde3a5010bc72d1}{HAL\_I2C\_STATE\_READY}})\ \{}
\DoxyCodeLine{00072\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_RESET\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00073\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a0c503d6c0388f0d872b368557e278b5a}{HAL\_I2C\_STATE\_BUSY}})\ \{}
\DoxyCodeLine{00074\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_BUSY\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00075\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37acb3a9e3d4d1076e0f4e65f91ca0161bc}{HAL\_I2C\_STATE\_BUSY\_TX}})\ \{}
\DoxyCodeLine{00076\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_BUSY\_TX\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00077\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a4ea4ecc2dc3cb64c4877c123d9d73170}{HAL\_I2C\_STATE\_BUSY\_RX}})\ \{}
\DoxyCodeLine{00078\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_BUSY\_RX\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00079\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a13518f06f54c7515100e86bb8d6e0779}{HAL\_I2C\_STATE\_LISTEN}})\ \{}
\DoxyCodeLine{00080\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_LISTEN\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00081\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a14d22553a60819b276582e08459f30b0}{HAL\_I2C\_STATE\_BUSY\_TX\_LISTEN}})\ \{}
\DoxyCodeLine{00082\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_BUSY\_TX\_LISTEN\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00083\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a8aec2547eedf1c9924f8efed33e3b5c5}{HAL\_I2C\_STATE\_BUSY\_RX\_LISTEN}})\ \{}
\DoxyCodeLine{00084\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_BUSY\_RX\_LISTEN\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00085\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a2c6f6d1fef0847f9da51153b5c295249}{HAL\_I2C\_STATE\_ABORT}})\ \{}
\DoxyCodeLine{00086\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_ABORT\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00087\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37a378abf24301fe7a23620fd78ff3f168b}{HAL\_I2C\_STATE\_TIMEOUT}})\ \{}
\DoxyCodeLine{00088\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_TIMEOUT\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00089\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (state\ ==\ \mbox{\hyperlink{group__HAL__state__structure__definition_ggaef355af8eab251ae2a19ee164ad81c37afe3c9b304462901099426a0d414be2a2}{HAL\_I2C\_STATE\_ERROR}})\ \{}
\DoxyCodeLine{00090\ \ \ \ \ printf(\textcolor{stringliteral}{"{}HAL\_I2C\_STATE\_ERROR\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ \ \ \textcolor{comment}{//\ while\ (HAL\_I2C\_GetState(\_bno055\_i2c\_port)\ !=\ HAL\_I2C\_STATE\_READY)\ \{\}}}
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//\ return;}}
\DoxyCodeLine{00094\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{keywordtype}{void}\ bno055\_readData(uint8\_t\ reg,\ uint8\_t\ *data,\ uint8\_t\ len)\ \{}
\DoxyCodeLine{00097\ \ \ HAL\_I2C\_Master\_Transmit(\_bno055\_i2c\_port,\ BNO055\_I2C\_ADDR\ <<\ 1,\ \&reg,\ 1,}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 100);}
\DoxyCodeLine{00099\ \ \ HAL\_I2C\_Master\_Receive(\_bno055\_i2c\_port,\ BNO055\_I2C\_ADDR\ <<\ 1,\ data,\ len,}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 100);}
\DoxyCodeLine{00101\ \ \ \textcolor{comment}{//\ HAL\_I2C\_Mem\_Read(\_bno055\_i2c\_port,\ BNO055\_I2C\_ADDR\_LO<<1,\ reg,}}
\DoxyCodeLine{00102\ \ \ \textcolor{comment}{//\ I2C\_MEMADD\_SIZE\_8BIT,\ data,\ len,\ 100);}}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00106\ \ \ \}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ BNO055\_STM32\_H\_}}

\end{DoxyCode}
